<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Events | The Outriders: MK</title>
  <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
  <header>
    <div class="branding">
    <img src="/assets/outriders.png" alt="The Outriders: MK logo">
    <h1><a href="/">The Outriders: MK</a></h1>
  </div>
    <!-- <h1><a href="/">The Outriders: MK</a></h1> -->
    <nav>
      <a href="/">Home</a> 
      <a href="/events/index.html">Events</a>
      <a href="/about/index.html">About</a>
      <a href="/links/index.html">Links</a>
    </nav>
  </header>
  <main>
    <h1 id="these-are-out-upcoming-events">These are out upcoming events</h1>

<!-- <!doctype html> -->
<html lang="en">

<body onload="fetch_events()">
    <div id="upcoming_events" class="div-event"></div>
    <script>
        function addXDay(date, X) {
            const result = new Date(date);
            result.setDate(result.getDate() + X);
            return new Date(result.toString());
        }

        function fetch_events() {
            fetch('/assets/events.json')
                .then(response => response.json())
                .then(data => {
                    const eventsContainer = document.getElementById('upcoming_events');
                    // sort by start_date (fallback to end_date) ascending
                    data.sort((a, b) => {
                        const da = new Date(a.start_date || a.end_date);
                        const db = new Date(b.start_date || b.end_date);
                        const na = isNaN(da);
                        const nb = isNaN(db);
                        if (na && nb) return 0;
                        if (na) return 1;
                        if (nb) return -1;
                        return da - db;
                    });
                    data.forEach(event => {
                        if(event.end_date && new Date(event.end_date) < addXDay(new Date(), -1)) {
                            return; // Skip past events
                        }
                        const eventDiv = document.createElement('div');
                        eventDiv.className = 'div-event';
                        eventDiv.innerHTML = `<h3>${event.name}</h3>`;
                        if (!event.end_date) {
                            eventDiv.innerHTML += `<p>Date: ${event.start_date}`;
                        } else {
                            
                            eventDiv.innerHTML += `<p>From: ${event.start_date} To: ${event.end_date}</p>`;
                            eventsContainer.appendChild(eventDiv);
                        }
                        if(event.links) {
                            const linksList = document.createElement('ul');
                            event.links.forEach(link => {
                                const linkItem = document.createElement('li');
                                linkItem.innerHTML = `<a href="${link.url}">${link.label}</a>`;
                                linksList.appendChild(linkItem);
                            });
                            eventDiv.appendChild(linksList);
                        }
                        if(event.additional_info) {
                            event.additional_info.forEach(info => {
                                const infoPara = document.createElement('p');
                                const strong = document.createElement('strong');
                                strong.textContent = `${info.label}: `;
                                infoPara.appendChild(strong);
                                infoPara.appendChild(document.createTextNode(info.value));
                                eventDiv.appendChild(infoPara);
                            });
                            
                        }
                    });
                })
                .catch(error => console.error('Error fetching events:', error));
        }
    </script>
    <link rel="stylesheet" href="/events/events.css" />
<!-- </html> -->

</body></html>

  </main>
  <footer>
    <p>&copy; 2025 The Outriders: MK</p>
  </footer>
</body>
</html>
